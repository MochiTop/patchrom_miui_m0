From 792f1212bc498b407f45b52f04ec86616bb86a8c Mon Sep 17 00:00:00 2001
From: nian0114 <268078545@qq.com>
Date: Tue, 7 Jul 2015 21:28:24 +0800
Subject: [PATCH] fix no image

---
 .../smali/com/zxing/camera/AutoFocusCallback.smali |   2 +
 .../zxing/camera/CameraConfigurationManager.smali  |  58 --
 .../smali/com/zxing/camera/CameraManager.smali     | 705 +++++++--------------
 3 files changed, 227 insertions(+), 703 deletions(-)
 delete mode 100644 BarcodeScanner/smali/com/zxing/camera/CameraManager$FlashAsyncTask.smali

--- a/BarcodeScanner/smali/com/zxing/camera/AutoFocusCallback.smali
+++ b/BarcodeScanner/smali/com/zxing/camera/AutoFocusCallback.smali
@@ -55,6 +55,8 @@
 
     if-eqz v1, :cond_0
 
+    if-eqz p1, :cond_0
+
     iget-object v1, p0, Lcom/zxing/camera/AutoFocusCallback;->autoFocusHandler:Landroid/os/Handler;
 
     iget v2, p0, Lcom/zxing/camera/AutoFocusCallback;->autoFocusMessage:I
--- a/BarcodeScanner/smali/com/zxing/camera/CameraConfigurationManager.smali
+++ b/BarcodeScanner/smali/com/zxing/camera/CameraConfigurationManager.smali
@@ -10,8 +10,6 @@
 
 .field private static final EXPOSURE_COMPENSATION:I = -0x2
 
-.field private static final MAC_CONTRAST:Ljava/lang/String; = "10"
-
 .field private static final TAG:Ljava/lang/String;
 
 .field private static final TEN_DESIRED_ZOOM:I = 0x96
@@ -501,51 +499,6 @@
     return v0
 .end method
 
-.method private setContrast(Landroid/hardware/Camera;Landroid/hardware/Camera$Parameters;)V
-    .locals 3
-    .param p1, "camera"    # Landroid/hardware/Camera;
-    .param p2, "parameters"    # Landroid/hardware/Camera$Parameters;
-
-    .prologue
-    :try_start_0
-    const-string v0, "10"
-
-    .local v0, "contrast":Ljava/lang/String;
-    const-string v2, "max-contrast"
-
-    invoke-virtual {p2, v2}, Landroid/hardware/Camera$Parameters;->get(Ljava/lang/String;)Ljava/lang/String;
-
-    move-result-object v1
-
-    .local v1, "maxContrast":Ljava/lang/String;
-    invoke-static {v1}, Landroid/text/TextUtils;->isEmpty(Ljava/lang/CharSequence;)Z
-
-    move-result v2
-
-    if-nez v2, :cond_0
-
-    move-object v0, v1
-
-    :cond_0
-    const-string v2, "contrast"
-
-    invoke-virtual {p2, v2, v0}, Landroid/hardware/Camera$Parameters;->set(Ljava/lang/String;Ljava/lang/String;)V
-
-    invoke-virtual {p1, p2}, Landroid/hardware/Camera;->setParameters(Landroid/hardware/Camera$Parameters;)V
-    :try_end_0
-    .catch Ljava/lang/Exception; {:try_start_0 .. :try_end_0} :catch_0
-
-    .end local v0    # "contrast":Ljava/lang/String;
-    .end local v1    # "maxContrast":Ljava/lang/String;
-    :goto_0
-    return-void
-
-    :catch_0
-    move-exception v2
-
-    goto :goto_0
-.end method
-
 .method private setFlash(Landroid/hardware/Camera$Parameters;)V
     .locals 2
     .param p1, "parameters"    # Landroid/hardware/Camera$Parameters;
@@ -950,8 +903,6 @@
 
     invoke-direct {p0, v0}, Lcom/zxing/camera/CameraConfigurationManager;->setZoom(Landroid/hardware/Camera$Parameters;)V
 
-    invoke-direct {p0, p1, v0}, Lcom/zxing/camera/CameraConfigurationManager;->setContrast(Landroid/hardware/Camera;Landroid/hardware/Camera$Parameters;)V
-
     const/16 v1, 0x5a
 
     invoke-virtual {p1, v1}, Landroid/hardware/Camera;->setDisplayOrientation(I)V
--- a/BarcodeScanner/smali/com/zxing/camera/CameraManager.smali
+++ b/BarcodeScanner/smali/com/zxing/camera/CameraManager.smali
@@ -3,14 +3,6 @@
 .source "CameraManager.java"
 
 
-# annotations
-.annotation system Ldalvik/annotation/MemberClasses;
-    value = {
-        Lcom/zxing/camera/CameraManager$FlashAsyncTask;
-    }
-.end annotation
-
-
 # static fields
 .field static final SDK_INT:I
 
@@ -34,8 +26,6 @@
 
 .field private initialized:Z
 
-.field private mIsFlashOn:Z
-
 .field private final previewCallback:Lcom/zxing/camera/PreviewCallback;
 
 .field private previewing:Z
@@ -87,33 +77,29 @@
     .param p1, "context"    # Landroid/content/Context;
 
     .prologue
-    const/4 v0, 0x0
-
     invoke-direct {p0}, Ljava/lang/Object;-><init>()V
 
-    iput-boolean v0, p0, Lcom/zxing/camera/CameraManager;->mIsFlashOn:Z
-
     iput-object p1, p0, Lcom/zxing/camera/CameraManager;->context:Landroid/content/Context;
 
-    new-instance v1, Lcom/zxing/camera/CameraConfigurationManager;
+    new-instance v0, Lcom/zxing/camera/CameraConfigurationManager;
 
-    invoke-direct {v1, p1}, Lcom/zxing/camera/CameraConfigurationManager;-><init>(Landroid/content/Context;)V
+    invoke-direct {v0, p1}, Lcom/zxing/camera/CameraConfigurationManager;-><init>(Landroid/content/Context;)V
 
-    iput-object v1, p0, Lcom/zxing/camera/CameraManager;->configManager:Lcom/zxing/camera/CameraConfigurationManager;
+    iput-object v0, p0, Lcom/zxing/camera/CameraManager;->configManager:Lcom/zxing/camera/CameraConfigurationManager;
 
-    sget-object v1, Landroid/os/Build$VERSION;->SDK:Ljava/lang/String;
+    sget-object v0, Landroid/os/Build$VERSION;->SDK:Ljava/lang/String;
 
-    invoke-static {v1}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I
+    invoke-static {v0}, Ljava/lang/Integer;->parseInt(Ljava/lang/String;)I
 
-    move-result v1
+    move-result v0
 
-    const/4 v2, 0x3
+    const/4 v1, 0x3
 
-    if-le v1, v2, :cond_0
+    if-le v0, v1, :cond_0
 
     const/4 v0, 0x1
 
-    :cond_0
+    :goto_0
     iput-boolean v0, p0, Lcom/zxing/camera/CameraManager;->useOneShotPreviewCallback:Z
 
     new-instance v0, Lcom/zxing/camera/PreviewCallback;
@@ -133,26 +119,11 @@
     iput-object v0, p0, Lcom/zxing/camera/CameraManager;->autoFocusCallback:Lcom/zxing/camera/AutoFocusCallback;
 
     return-void
-.end method
 
-.method static synthetic access$000(Lcom/zxing/camera/CameraManager;)Landroid/hardware/Camera;
-    .locals 1
-    .param p0, "x0"    # Lcom/zxing/camera/CameraManager;
-
-    .prologue
-    iget-object v0, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
-
-    return-object v0
-.end method
-
-.method static synthetic access$100(Lcom/zxing/camera/CameraManager;)Z
-    .locals 1
-    .param p0, "x0"    # Lcom/zxing/camera/CameraManager;
-
-    .prologue
-    iget-boolean v0, p0, Lcom/zxing/camera/CameraManager;->mIsFlashOn:Z
+    :cond_0
+    const/4 v0, 0x0
 
-    return v0
+    goto :goto_0
 .end method
 
 .method public static get()Lcom/zxing/camera/CameraManager;
@@ -306,16 +277,13 @@
 
 
 # virtual methods
-.method public declared-synchronized buildLuminanceSource([BII)Lcom/zxing/camera/PlanarYUVLuminanceSource;
+.method public buildLuminanceSource([BII)Lcom/zxing/camera/PlanarYUVLuminanceSource;
     .locals 11
     .param p1, "data"    # [B
     .param p2, "width"    # I
     .param p3, "height"    # I
 
     .prologue
-    monitor-enter p0
-
-    :try_start_0
     invoke-virtual {p0}, Lcom/zxing/camera/CameraManager;->getFramingRectInPreview()Landroid/graphics/Rect;
 
     move-result-object v10
@@ -366,16 +334,11 @@
     move v3, p3
 
     invoke-direct/range {v0 .. v7}, Lcom/zxing/camera/PlanarYUVLuminanceSource;-><init>([BIIIIII)V
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
     :goto_0
-    monitor-exit p0
-
     return-object v0
 
     :pswitch_0
-    :try_start_1
     new-instance v0, Lcom/zxing/camera/PlanarYUVLuminanceSource;
 
     iget v4, v10, Landroid/graphics/Rect;->left:I
@@ -397,26 +360,10 @@
     move v3, p3
 
     invoke-direct/range {v0 .. v7}, Lcom/zxing/camera/PlanarYUVLuminanceSource;-><init>([BIIIIII)V
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
     goto :goto_0
 
-    .end local v8    # "previewFormat":I
-    .end local v9    # "previewFormatString":Ljava/lang/String;
-    .end local v10    # "rect":Landroid/graphics/Rect;
-    :catchall_0
-    move-exception v0
-
-    monitor-exit p0
-
-    throw v0
-
-    .restart local v8    # "previewFormat":I
-    .restart local v9    # "previewFormatString":Ljava/lang/String;
-    .restart local v10    # "rect":Landroid/graphics/Rect;
     :cond_0
-    :try_start_2
     new-instance v0, Ljava/lang/IllegalArgumentException;
 
     new-instance v1, Ljava/lang/StringBuilder;
@@ -450,8 +397,6 @@
     invoke-direct {v0, v1}, Ljava/lang/IllegalArgumentException;-><init>(Ljava/lang/String;)V
 
     throw v0
-    :try_end_2
-    .catchall {:try_start_2 .. :try_end_2} :catchall_0
 
     nop
 
@@ -462,13 +407,10 @@
     .end packed-switch
 .end method
 
-.method public declared-synchronized closeDriver()V
+.method public closeDriver()V
     .locals 1
 
     .prologue
-    monitor-enter p0
-
-    :try_start_0
     iget-object v0, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
 
     if-eqz v0, :cond_0
@@ -482,20 +424,9 @@
     const/4 v0, 0x0
 
     iput-object v0, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
     :cond_0
-    monitor-exit p0
-
     return-void
-
-    :catchall_0
-    move-exception v0
-
-    monitor-exit p0
-
-    throw v0
 .end method
 
 .method public getContext()Landroid/content/Context;
@@ -507,215 +438,169 @@
     return-object v0
 .end method
 
-.method public declared-synchronized getFramingRect()Landroid/graphics/Rect;
-    .locals 9
+.method public getFramingRect()Landroid/graphics/Rect;
+    .locals 8
 
     .prologue
-    const/4 v6, 0x0
-
-    monitor-enter p0
-
-    :try_start_0
     invoke-static {}, Lcom/miui/barcodescanner/activity/BaseActivity;->isMiPad()Z
 
-    move-result v7
+    move-result v5
 
-    if-eqz v7, :cond_1
+    if-eqz v5, :cond_0
 
     invoke-virtual {p0}, Lcom/zxing/camera/CameraManager;->getScreenResolution()Landroid/graphics/Point;
 
-    move-result-object v3
+    move-result-object v2
 
-    .local v3, "screenResolution":Landroid/graphics/Point;
+    .local v2, "screenResolution":Landroid/graphics/Point;
     :goto_0
-    sget-object v7, Lcom/zxing/camera/CameraManager;->TAG:Ljava/lang/String;
+    sget-object v5, Lcom/zxing/camera/CameraManager;->TAG:Ljava/lang/String;
 
-    const-string v8, "Calculated framing rect begin"
+    const-string v6, "Calculated framing rect begin"
 
-    invoke-static {v7, v8}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    invoke-static {v5, v6}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    iget-object v7, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
+    iget-object v5, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
 
-    if-nez v7, :cond_2
+    if-nez v5, :cond_1
 
-    :cond_0
-    :goto_1
-    monitor-exit p0
+    const/4 v5, 0x0
 
-    return-object v6
+    :goto_1
+    return-object v5
 
-    .end local v3    # "screenResolution":Landroid/graphics/Point;
-    :cond_1
-    :try_start_1
-    iget-object v7, p0, Lcom/zxing/camera/CameraManager;->configManager:Lcom/zxing/camera/CameraConfigurationManager;
+    .end local v2    # "screenResolution":Landroid/graphics/Point;
+    :cond_0
+    iget-object v5, p0, Lcom/zxing/camera/CameraManager;->configManager:Lcom/zxing/camera/CameraConfigurationManager;
 
-    invoke-virtual {v7}, Lcom/zxing/camera/CameraConfigurationManager;->getScreenResolution()Landroid/graphics/Point;
+    invoke-virtual {v5}, Lcom/zxing/camera/CameraConfigurationManager;->getScreenResolution()Landroid/graphics/Point;
 
-    move-result-object v3
+    move-result-object v2
 
     goto :goto_0
 
-    .restart local v3    # "screenResolution":Landroid/graphics/Point;
-    :cond_2
-    iget-object v7, p0, Lcom/zxing/camera/CameraManager;->context:Landroid/content/Context;
-
-    invoke-virtual {v7}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
-
-    move-result-object v7
-
-    const/high16 v8, 0x7f080000
-
-    invoke-virtual {v7, v8}, Landroid/content/res/Resources;->getDimension(I)F
-
-    move-result v7
-
-    float-to-int v4, v7
-
-    .local v4, "sideLength":I
-    iget-object v7, p0, Lcom/zxing/camera/CameraManager;->context:Landroid/content/Context;
-
-    invoke-virtual {v7}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
-
-    move-result-object v7
+    .restart local v2    # "screenResolution":Landroid/graphics/Point;
+    :cond_1
+    iget-object v5, p0, Lcom/zxing/camera/CameraManager;->context:Landroid/content/Context;
 
-    const v8, 0x7f080001
+    invoke-virtual {v5}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
-    invoke-virtual {v7, v8}, Landroid/content/res/Resources;->getDimension(I)F
+    move-result-object v5
 
-    move-result v7
+    const/high16 v6, 0x7f080000
 
-    float-to-int v0, v7
+    invoke-virtual {v5, v6}, Landroid/content/res/Resources;->getDimension(I)F
 
-    .local v0, "height":I
-    if-eqz v3, :cond_0
+    move-result v5
 
-    iget v6, v3, Landroid/graphics/Point;->x:I
+    float-to-int v3, v5
 
-    sub-int/2addr v6, v4
+    .local v3, "sideLength":I
+    iget v5, v2, Landroid/graphics/Point;->x:I
 
-    div-int/lit8 v1, v6, 0x2
+    sub-int/2addr v5, v3
 
-    .local v1, "leftOffset":I
-    iget v6, v3, Landroid/graphics/Point;->y:I
+    div-int/lit8 v0, v5, 0x2
 
-    sub-int/2addr v6, v0
+    .local v0, "leftOffset":I
+    iget v5, v2, Landroid/graphics/Point;->y:I
 
-    div-int/lit8 v5, v6, 0x2
+    sub-int/2addr v5, v3
 
-    .local v5, "topOffset":I
-    iget-object v6, p0, Lcom/zxing/camera/CameraManager;->context:Landroid/content/Context;
+    div-int/lit8 v4, v5, 0x2
 
-    invoke-virtual {v6}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
+    .local v4, "topOffset":I
+    iget-object v5, p0, Lcom/zxing/camera/CameraManager;->context:Landroid/content/Context;
 
-    move-result-object v6
+    invoke-virtual {v5}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
-    invoke-virtual {v6}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
+    move-result-object v5
 
-    move-result-object v6
+    invoke-virtual {v5}, Landroid/content/res/Resources;->getConfiguration()Landroid/content/res/Configuration;
 
-    iget v2, v6, Landroid/content/res/Configuration;->orientation:I
+    move-result-object v5
 
-    .local v2, "orientaion":I
-    iget-object v6, p0, Lcom/zxing/camera/CameraManager;->context:Landroid/content/Context;
+    iget v1, v5, Landroid/content/res/Configuration;->orientation:I
 
-    check-cast v6, Landroid/app/Activity;
+    .local v1, "orientaion":I
+    iget-object v5, p0, Lcom/zxing/camera/CameraManager;->context:Landroid/content/Context;
 
-    const/4 v7, 0x0
+    check-cast v5, Landroid/app/Activity;
 
-    iget-object v8, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
+    const/4 v6, 0x0
 
-    invoke-static {v6, v7, v8}, Lcom/zxing/camera/CameraManager;->setCameraDisplayOrientation(Landroid/app/Activity;ILandroid/hardware/Camera;)V
+    iget-object v7, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
 
-    iget-object v6, p0, Lcom/zxing/camera/CameraManager;->context:Landroid/content/Context;
+    invoke-static {v5, v6, v7}, Lcom/zxing/camera/CameraManager;->setCameraDisplayOrientation(Landroid/app/Activity;ILandroid/hardware/Camera;)V
 
-    invoke-virtual {v6}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
+    invoke-static {}, Lcom/miui/barcodescanner/activity/BaseActivity;->isMiPad()Z
 
-    move-result-object v6
+    move-result v5
 
-    const v7, 0x7f08000c
+    if-eqz v5, :cond_2
 
-    invoke-virtual {v6, v7}, Landroid/content/res/Resources;->getDimension(I)F
+    const/4 v5, 0x2
 
-    move-result v6
+    if-ne v1, v5, :cond_2
 
-    float-to-int v5, v6
+    iget-object v5, p0, Lcom/zxing/camera/CameraManager;->context:Landroid/content/Context;
 
-    invoke-static {}, Lcom/miui/barcodescanner/activity/BaseActivity;->isMiPad()Z
+    invoke-virtual {v5}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
-    move-result v6
-
-    if-eqz v6, :cond_3
-
-    const/4 v6, 0x1
+    move-result-object v5
 
-    if-ne v2, v6, :cond_3
+    const v6, 0x7f08000b
 
-    const/4 v5, 0x0
+    invoke-virtual {v5, v6}, Landroid/content/res/Resources;->getDimension(I)F
 
-    :cond_3
-    new-instance v6, Landroid/graphics/Rect;
+    move-result v5
 
-    add-int v7, v1, v4
+    float-to-int v4, v5
 
-    add-int v8, v5, v4
-
-    invoke-direct {v6, v1, v5, v7, v8}, Landroid/graphics/Rect;-><init>(IIII)V
+    :cond_2
+    new-instance v5, Landroid/graphics/Rect;
 
-    iput-object v6, p0, Lcom/zxing/camera/CameraManager;->framingRect:Landroid/graphics/Rect;
+    add-int v6, v0, v3
 
-    sget-object v6, Lcom/zxing/camera/CameraManager;->TAG:Ljava/lang/String;
+    add-int v7, v4, v3
 
-    new-instance v7, Ljava/lang/StringBuilder;
+    invoke-direct {v5, v0, v4, v6, v7}, Landroid/graphics/Rect;-><init>(IIII)V
 
-    invoke-direct {v7}, Ljava/lang/StringBuilder;-><init>()V
+    iput-object v5, p0, Lcom/zxing/camera/CameraManager;->framingRect:Landroid/graphics/Rect;
 
-    const-string v8, "Calculated framing rect: "
+    sget-object v5, Lcom/zxing/camera/CameraManager;->TAG:Ljava/lang/String;
 
-    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
+    new-instance v6, Ljava/lang/StringBuilder;
 
-    move-result-object v7
+    invoke-direct {v6}, Ljava/lang/StringBuilder;-><init>()V
 
-    iget-object v8, p0, Lcom/zxing/camera/CameraManager;->framingRect:Landroid/graphics/Rect;
+    const-string v7, "Calculated framing rect: "
 
-    invoke-virtual {v7, v8}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
+    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;
 
-    move-result-object v7
+    move-result-object v6
 
-    invoke-virtual {v7}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
+    iget-object v7, p0, Lcom/zxing/camera/CameraManager;->framingRect:Landroid/graphics/Rect;
 
-    move-result-object v7
+    invoke-virtual {v6, v7}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
 
-    invoke-static {v6, v7}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
+    move-result-object v6
 
-    iget-object v6, p0, Lcom/zxing/camera/CameraManager;->framingRect:Landroid/graphics/Rect;
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
+    invoke-virtual {v6}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;
 
-    goto/16 :goto_1
+    move-result-object v6
 
-    .end local v0    # "height":I
-    .end local v1    # "leftOffset":I
-    .end local v2    # "orientaion":I
-    .end local v3    # "screenResolution":Landroid/graphics/Point;
-    .end local v4    # "sideLength":I
-    .end local v5    # "topOffset":I
-    :catchall_0
-    move-exception v6
+    invoke-static {v5, v6}, Landroid/util/Log;->d(Ljava/lang/String;Ljava/lang/String;)I
 
-    monitor-exit p0
+    iget-object v5, p0, Lcom/zxing/camera/CameraManager;->framingRect:Landroid/graphics/Rect;
 
-    throw v6
+    goto :goto_1
 .end method
 
-.method public declared-synchronized getFramingRectInPreview()Landroid/graphics/Rect;
+.method public getFramingRectInPreview()Landroid/graphics/Rect;
     .locals 5
 
     .prologue
-    monitor-enter p0
-
-    :try_start_0
     iget-object v3, p0, Lcom/zxing/camera/CameraManager;->framingRectInPreview:Landroid/graphics/Rect;
 
     if-nez v3, :cond_0
@@ -798,19 +683,8 @@
     .end local v2    # "screenResolution":Landroid/graphics/Point;
     :cond_0
     iget-object v3, p0, Lcom/zxing/camera/CameraManager;->framingRectInPreview:Landroid/graphics/Rect;
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    monitor-exit p0
 
     return-object v3
-
-    :catchall_0
-    move-exception v3
-
-    monitor-exit p0
-
-    throw v3
 .end method
 
 .method public getScreenResolution()Landroid/graphics/Point;
@@ -852,7 +726,7 @@
     return-object v2
 .end method
 
-.method public declared-synchronized openDriver(Landroid/view/SurfaceHolder;)V
+.method public openDriver(Landroid/view/SurfaceHolder;)V
     .locals 2
     .param p1, "holder"    # Landroid/view/SurfaceHolder;
     .annotation system Ldalvik/annotation/Throws;
@@ -862,9 +736,6 @@
     .end annotation
 
     .prologue
-    monitor-enter p0
-
-    :try_start_0
     iget-object v0, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
 
     if-nez v0, :cond_2
@@ -884,18 +755,8 @@
     invoke-direct {v0}, Ljava/io/IOException;-><init>()V
 
     throw v0
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
-
-    :catchall_0
-    move-exception v0
-
-    monitor-exit p0
-
-    throw v0
 
     :cond_0
-    :try_start_1
     iget-object v0, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
 
     const/16 v1, 0x5a
@@ -928,24 +789,17 @@
     invoke-virtual {v0, v1}, Lcom/zxing/camera/CameraConfigurationManager;->setDesiredCameraParameters(Landroid/hardware/Camera;)V
 
     invoke-static {}, Lcom/zxing/camera/FlashlightManager;->enableFlashlight()V
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
     :cond_2
-    monitor-exit p0
-
     return-void
 .end method
 
-.method public declared-synchronized requestAutoFocus(Landroid/os/Handler;I)V
+.method public requestAutoFocus(Landroid/os/Handler;I)V
     .locals 2
     .param p1, "handler"    # Landroid/os/Handler;
     .param p2, "message"    # I
 
     .prologue
-    monitor-enter p0
-
-    :try_start_0
     iget-object v0, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
 
     if-eqz v0, :cond_0
@@ -963,31 +817,17 @@
     iget-object v1, p0, Lcom/zxing/camera/CameraManager;->autoFocusCallback:Lcom/zxing/camera/AutoFocusCallback;
 
     invoke-virtual {v0, v1}, Landroid/hardware/Camera;->autoFocus(Landroid/hardware/Camera$AutoFocusCallback;)V
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
     :cond_0
-    monitor-exit p0
-
     return-void
-
-    :catchall_0
-    move-exception v0
-
-    monitor-exit p0
-
-    throw v0
 .end method
 
-.method public declared-synchronized requestPreviewFrame(Landroid/os/Handler;I)V
+.method public requestPreviewFrame(Landroid/os/Handler;I)V
     .locals 2
     .param p1, "handler"    # Landroid/os/Handler;
     .param p2, "message"    # I
 
     .prologue
-    monitor-enter p0
-
-    :try_start_0
     iget-object v0, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
 
     if-eqz v0, :cond_0
@@ -1009,42 +849,25 @@
     iget-object v1, p0, Lcom/zxing/camera/CameraManager;->previewCallback:Lcom/zxing/camera/PreviewCallback;
 
     invoke-virtual {v0, v1}, Landroid/hardware/Camera;->setOneShotPreviewCallback(Landroid/hardware/Camera$PreviewCallback;)V
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
     :cond_0
     :goto_0
-    monitor-exit p0
-
     return-void
 
     :cond_1
-    :try_start_1
     iget-object v0, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
 
     iget-object v1, p0, Lcom/zxing/camera/CameraManager;->previewCallback:Lcom/zxing/camera/PreviewCallback;
 
     invoke-virtual {v0, v1}, Landroid/hardware/Camera;->setPreviewCallback(Landroid/hardware/Camera$PreviewCallback;)V
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
 
     goto :goto_0
-
-    :catchall_0
-    move-exception v0
-
-    monitor-exit p0
-
-    throw v0
 .end method
 
-.method public declared-synchronized startPreview()V
+.method public startPreview()V
     .locals 1
 
     .prologue
-    monitor-enter p0
-
-    :try_start_0
     iget-object v0, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
 
     if-eqz v0, :cond_0
@@ -1060,29 +883,19 @@
     const/4 v0, 0x1
 
     iput-boolean v0, p0, Lcom/zxing/camera/CameraManager;->previewing:Z
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
 
     :cond_0
-    monitor-exit p0
-
     return-void
-
-    :catchall_0
-    move-exception v0
-
-    monitor-exit p0
-
-    throw v0
 .end method
 
-.method public declared-synchronized stopPreview()V
+.method public stopPreview()V
     .locals 3
 
     .prologue
-    monitor-enter p0
+    const/4 v2, 0x0
+
+    const/4 v1, 0x0
 
-    :try_start_0
     iget-object v0, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
 
     if-eqz v0, :cond_1
@@ -1097,9 +910,7 @@
 
     iget-object v0, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
 
-    const/4 v1, 0x0
-
-    invoke-virtual {v0, v1}, Landroid/hardware/Camera;->setPreviewCallback(Landroid/hardware/Camera$PreviewCallback;)V
+    invoke-virtual {v0, v2}, Landroid/hardware/Camera;->setPreviewCallback(Landroid/hardware/Camera$PreviewCallback;)V
 
     :cond_0
     iget-object v0, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
@@ -1108,189 +919,137 @@
 
     iget-object v0, p0, Lcom/zxing/camera/CameraManager;->previewCallback:Lcom/zxing/camera/PreviewCallback;
 
-    const/4 v1, 0x0
-
-    const/4 v2, 0x0
-
-    invoke-virtual {v0, v1, v2}, Lcom/zxing/camera/PreviewCallback;->setHandler(Landroid/os/Handler;I)V
+    invoke-virtual {v0, v2, v1}, Lcom/zxing/camera/PreviewCallback;->setHandler(Landroid/os/Handler;I)V
 
     iget-object v0, p0, Lcom/zxing/camera/CameraManager;->autoFocusCallback:Lcom/zxing/camera/AutoFocusCallback;
 
-    const/4 v1, 0x0
-
-    const/4 v2, 0x0
-
-    invoke-virtual {v0, v1, v2}, Lcom/zxing/camera/AutoFocusCallback;->setHandler(Landroid/os/Handler;I)V
+    invoke-virtual {v0, v2, v1}, Lcom/zxing/camera/AutoFocusCallback;->setHandler(Landroid/os/Handler;I)V
 
-    const/4 v0, 0x0
-
-    iput-boolean v0, p0, Lcom/zxing/camera/CameraManager;->previewing:Z
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
+    iput-boolean v1, p0, Lcom/zxing/camera/CameraManager;->previewing:Z
 
     :cond_1
-    monitor-exit p0
-
     return-void
-
-    :catchall_0
-    move-exception v0
-
-    monitor-exit p0
-
-    throw v0
 .end method
 
-.method public declared-synchronized turnOffFlash()V
-    .locals 3
+.method public turnOffFlash()V
+    .locals 4
 
     .prologue
-    monitor-enter p0
+    iget-object v1, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
 
-    const/4 v0, 0x0
+    if-eqz v1, :cond_0
 
-    :try_start_0
-    iput-boolean v0, p0, Lcom/zxing/camera/CameraManager;->mIsFlashOn:Z
-
-    iget-object v0, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
+    iget-object v1, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
 
-    if-eqz v0, :cond_0
+    invoke-virtual {v1}, Landroid/hardware/Camera;->getParameters()Landroid/hardware/Camera$Parameters;
 
-    new-instance v0, Lcom/zxing/camera/CameraManager$FlashAsyncTask;
+    move-result-object v0
 
-    invoke-direct {v0, p0}, Lcom/zxing/camera/CameraManager$FlashAsyncTask;-><init>(Lcom/zxing/camera/CameraManager;)V
+    .local v0, "param":Landroid/hardware/Camera$Parameters;
+    const-string v1, "off"
 
-    const/4 v1, 0x0
+    invoke-virtual {v0, v1}, Landroid/hardware/Camera$Parameters;->setFlashMode(Ljava/lang/String;)V
 
-    new-array v1, v1, [Ljava/lang/Void;
+    iget-object v1, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
 
-    invoke-virtual {v0, v1}, Lcom/zxing/camera/CameraManager$FlashAsyncTask;->execute([Ljava/lang/Object;)Landroid/os/AsyncTask;
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
+    invoke-virtual {v1, v0}, Landroid/hardware/Camera;->setParameters(Landroid/hardware/Camera$Parameters;)V
 
+    .end local v0    # "param":Landroid/hardware/Camera$Parameters;
     :goto_0
-    monitor-exit p0
-
     return-void
 
     :cond_0
-    :try_start_1
     invoke-virtual {p0}, Lcom/zxing/camera/CameraManager;->getContext()Landroid/content/Context;
 
-    move-result-object v0
+    move-result-object v1
 
     invoke-virtual {p0}, Lcom/zxing/camera/CameraManager;->getContext()Landroid/content/Context;
 
-    move-result-object v1
+    move-result-object v2
 
-    invoke-virtual {v1}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
+    invoke-virtual {v2}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
-    move-result-object v1
+    move-result-object v2
 
-    const v2, 0x7f0a0012
+    const v3, 0x7f0a0012
 
-    invoke-virtual {v1, v2}, Landroid/content/res/Resources;->getString(I)Ljava/lang/String;
+    invoke-virtual {v2, v3}, Landroid/content/res/Resources;->getString(I)Ljava/lang/String;
 
-    move-result-object v1
+    move-result-object v2
 
-    const/4 v2, 0x0
+    const/4 v3, 0x0
 
-    invoke-static {v0, v1, v2}, Landroid/widget/Toast;->makeText(Landroid/content/Context;Ljava/lang/CharSequence;I)Landroid/widget/Toast;
+    invoke-static {v1, v2, v3}, Landroid/widget/Toast;->makeText(Landroid/content/Context;Ljava/lang/CharSequence;I)Landroid/widget/Toast;
 
-    move-result-object v0
+    move-result-object v1
 
-    invoke-virtual {v0}, Landroid/widget/Toast;->show()V
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
+    invoke-virtual {v1}, Landroid/widget/Toast;->show()V
 
     goto :goto_0
-
-    :catchall_0
-    move-exception v0
-
-    monitor-exit p0
-
-    throw v0
 .end method
 
-.method public declared-synchronized turnOnFlash()V
-    .locals 3
+.method public turnOnFlash()V
+    .locals 4
 
     .prologue
-    monitor-enter p0
-
-    :try_start_0
-    iget-object v0, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
+    iget-object v1, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
 
-    if-nez v0, :cond_0
+    if-nez v1, :cond_0
 
     invoke-static {}, Landroid/hardware/Camera;->open()Landroid/hardware/Camera;
 
-    move-result-object v0
+    move-result-object v1
 
-    iput-object v0, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
+    iput-object v1, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
 
-    iget-object v0, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
+    iget-object v1, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
 
-    if-nez v0, :cond_0
+    if-nez v1, :cond_0
 
     invoke-virtual {p0}, Lcom/zxing/camera/CameraManager;->getContext()Landroid/content/Context;
 
-    move-result-object v0
+    move-result-object v1
 
     invoke-virtual {p0}, Lcom/zxing/camera/CameraManager;->getContext()Landroid/content/Context;
 
-    move-result-object v1
+    move-result-object v2
 
-    invoke-virtual {v1}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
+    invoke-virtual {v2}, Landroid/content/Context;->getResources()Landroid/content/res/Resources;
 
-    move-result-object v1
+    move-result-object v2
 
-    const v2, 0x7f0a0011
+    const v3, 0x7f0a0011
 
-    invoke-virtual {v1, v2}, Landroid/content/res/Resources;->getString(I)Ljava/lang/String;
+    invoke-virtual {v2, v3}, Landroid/content/res/Resources;->getString(I)Ljava/lang/String;
 
-    move-result-object v1
+    move-result-object v2
 
-    const/4 v2, 0x0
+    const/4 v3, 0x0
 
-    invoke-static {v0, v1, v2}, Landroid/widget/Toast;->makeText(Landroid/content/Context;Ljava/lang/CharSequence;I)Landroid/widget/Toast;
+    invoke-static {v1, v2, v3}, Landroid/widget/Toast;->makeText(Landroid/content/Context;Ljava/lang/CharSequence;I)Landroid/widget/Toast;
 
-    move-result-object v0
+    move-result-object v1
 
-    invoke-virtual {v0}, Landroid/widget/Toast;->show()V
-    :try_end_0
-    .catchall {:try_start_0 .. :try_end_0} :catchall_0
+    invoke-virtual {v1}, Landroid/widget/Toast;->show()V
 
     :goto_0
-    monitor-exit p0
-
     return-void
 
     :cond_0
-    const/4 v0, 0x1
+    iget-object v1, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
 
-    :try_start_1
-    iput-boolean v0, p0, Lcom/zxing/camera/CameraManager;->mIsFlashOn:Z
+    invoke-virtual {v1}, Landroid/hardware/Camera;->getParameters()Landroid/hardware/Camera$Parameters;
 
-    new-instance v0, Lcom/zxing/camera/CameraManager$FlashAsyncTask;
+    move-result-object v0
 
-    invoke-direct {v0, p0}, Lcom/zxing/camera/CameraManager$FlashAsyncTask;-><init>(Lcom/zxing/camera/CameraManager;)V
+    .local v0, "param":Landroid/hardware/Camera$Parameters;
+    const-string v1, "torch"
 
-    const/4 v1, 0x0
+    invoke-virtual {v0, v1}, Landroid/hardware/Camera$Parameters;->setFlashMode(Ljava/lang/String;)V
 
-    new-array v1, v1, [Ljava/lang/Void;
+    iget-object v1, p0, Lcom/zxing/camera/CameraManager;->camera:Landroid/hardware/Camera;
 
-    invoke-virtual {v0, v1}, Lcom/zxing/camera/CameraManager$FlashAsyncTask;->execute([Ljava/lang/Object;)Landroid/os/AsyncTask;
-    :try_end_1
-    .catchall {:try_start_1 .. :try_end_1} :catchall_0
+    invoke-virtual {v1, v0}, Landroid/hardware/Camera;->setParameters(Landroid/hardware/Camera$Parameters;)V
 
     goto :goto_0
-
-    :catchall_0
-    move-exception v0
-
-    monitor-exit p0
-
-    throw v0
 .end method
-- 
1.9.1

